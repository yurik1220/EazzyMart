<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Eazzy Mart ‚Äî Shop Fresh Daily</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Custom CSS - Load after Bootstrap to override -->
  <link rel="stylesheet" href="../css/webstyle.css">
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <!-- Header (Shopee Style) -->
  <header>
    <div class="header-container">
      <a href="#browse" class="logo">
        <img src="../assets/images/eazzymartlogo.png" alt="Eazzy Mart Logo">
        <span>Eazzy Mart</span>
      </a>
      
      <div class="search-container">
        <form class="search-form">
          <input type="search" class="search-input" placeholder="Search for products..." aria-label="Search">
          <button type="submit" class="search-btn">
            <i class="fas fa-search"></i>
          </button>
        </form>
      </div>

      <div class="header-actions">
        <a href="Cart.html" class="cart-btn" style="text-decoration: none;">
          <i class="fas fa-shopping-cart"></i>
          <span>Cart</span>
          <span class="cart-badge" id="cart-count">0</span>
        </a>
        <a href="OrderTracking.html" class="checkout-btn" style="text-decoration: none;">
          <i class="fas fa-box-open"></i>
          <span>Orders</span>
        </a>
        <button type="button" class="logout-btn" id="logout-btn">
          <i class="fas fa-sign-out-alt"></i>
          <span>Logout</span>
        </button>
      </div>
    </div>
  </header>

  <!-- Flash Deals Banner (Shopee Style) -->
  <section class="flash-deals-section">
    <div class="flash-deals-content">
      <div class="flash-deals-text">
        <h2>‚ö° Flash Deals!</h2>
        <p>Grab up to <strong>50% OFF</strong> ‚Äî Limited time only!</p>
      </div>
      <img src="../assets/images/flash-deals.png" alt="Flash Sale" class="flash-deals-img">
    </div>
  </section>

  <!-- Categories (Shopee Style) -->
  <section class="categories-section">
    <h2>Shop by Category</h2>
    <div class="categories-grid">
      <a href="#fresh-produce" class="category-item" data-category="fresh produce">
        <div class="icon">üçé</div>
        <div class="name">Fresh Produce</div>
      </a>
      <a href="#dairy" class="category-item" data-category="dairy">
        <div class="icon">ü•õ</div>
        <div class="name">Dairy</div>
      </a>
      <a href="#snacks" class="category-item" data-category="snacks">
        <div class="icon">üç´</div>
        <div class="name">Snacks</div>
      </a>
      <a href="#beverages" class="category-item" data-category="beverages">
        <div class="icon">ü•§</div>
        <div class="name">Beverages</div>
      </a>
      <a href="#frozen-foods" class="category-item" data-category="frozen foods">
        <div class="icon">üßä</div>
        <div class="name">Frozen Foods</div>
      </a>
      <a href="#canned-goods" class="category-item" data-category="canned goods">
        <div class="icon">ü•´</div>
        <div class="name">Canned Goods</div>
      </a>
      <a href="#household-items" class="category-item" data-category="household items">
        <div class="icon">üßπ</div>
        <div class="name">Household Items</div>
      </a>
      <a href="#personal-care" class="category-item" data-category="personal care">
        <div class="icon">üß¥</div>
        <div class="name">Personal Care</div>
      </a>
    </div>
  </section>

  <!-- Products Section (Shopee Style) -->
  <section class="products-section" id="browse">
    <div class="section-header">
      <h2 class="section-title">All Products</h2>
    </div>
    <div id="product-list"></div>
  </section>

  <!-- Checkout Section (Shopee Style) -->
  <section id="checkout-section" class="d-none">
    <div class="checkout-header">
      <h2>Checkout</h2>
    </div>
    <form id="checkout-form">
      <div class="form-group">
        <label for="orderType" class="form-label">Order Type</label>
        <select id="orderType" name="orderType" class="form-select" required>
          <option value="" disabled selected>Select Order Type</option>
          <option value="Delivery">Delivery</option>
          <option value="Pickup">Pickup</option>
        </select>
      </div>

      <div class="form-group">
        <label for="name" class="form-label">Full Name</label>
        <input type="text" class="form-control" id="name" name="name" placeholder="Enter your full name" required>
      </div>

      <div class="form-group" id="address-group">
        <label for="address" class="form-label">Delivery Address</label>
        <input type="text" class="form-control" id="address" name="address" placeholder="Enter delivery address" required>
      </div>

      <div class="form-group" id="contact-group">
        <label for="contactnumber" class="form-label">Contact Number</label>
        <input type="text" class="form-control" id="contactnumber" name="contactnumber" placeholder="Enter contact number" required>
      </div>

      <div class="form-group">
        <label for="payment" class="form-label">Payment Method</label>
        <select id="payment" name="payment" class="form-select" required>
          <option value="" disabled selected>Select Payment Method</option>
          <option value="Cash On Delivery">Cash On Delivery</option>
          <option value="GCash">GCash</option>
          <option value="Pay at the store" id="pay-at-store-option">Pay at the store</option>
        </select>
      </div>

      <button type="submit" class="btn-success">
        <i class="fas fa-check"></i> Complete Order
      </button>
    </form>

    <div style="margin-top: 20px;">
      <button id="back-to-cart" class="btn btn-secondary" style="width: 100%;">
        <i class="fas fa-arrow-left"></i> Back to Cart
      </button>
    </div>
  </section>

  <!-- Product Detail Modal -->
  <div id="productModal" class="product-modal">
    <div class="product-modal-overlay"></div>
    <div class="product-modal-content">
      <button class="product-modal-close" id="closeProductModal" aria-label="Close modal">
        <i class="fas fa-times"></i>
      </button>
      <div class="product-modal-body">
        <div class="product-modal-image-section">
          <img id="modalProductImage" src="" alt="Product Image" class="product-modal-image">
        </div>
        <div class="product-modal-info-section">
          <h2 id="modalProductName" class="product-modal-name"></h2>
          <div class="product-modal-price-section">
            <span id="modalProductPrice" class="product-modal-price"></span>
          </div>
          <div class="product-modal-category">
            <span id="modalProductCategory" class="category-badge"></span>
          </div>
          <div class="product-modal-description">
            <h3>Description</h3>
            <p id="modalProductDescription"></p>
          </div>
          <div class="product-modal-stock">
            <span id="modalProductStock" class="stock-info"></span>
          </div>
          <div class="product-modal-actions">
            <div class="quantity-selector">
              <label for="modalQuantity">Quantity:</label>
              <div class="quantity-controls">
                <button type="button" class="quantity-btn" id="decreaseQuantity">
                  <i class="fas fa-minus"></i>
                </button>
                <input type="number" id="modalQuantity" class="quantity-input" value="1" min="1" max="1">
                <button type="button" class="quantity-btn" id="increaseQuantity">
                  <i class="fas fa-plus"></i>
                </button>
              </div>
            </div>
            <button type="button" class="btn-add-to-cart-modal" id="addToCartFromModal">
              <i class="fas fa-shopping-cart"></i>
              Add to Cart
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <p>&copy; 2025 Eazzy Mart. All rights reserved.</p>
  </footer>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <script src="../js/Index.js"></script>

  <script>
    const checkoutSection = document.getElementById('checkout-section');
    const browseSection = document.getElementById('browse');

    const openCheckout = () => {
      browseSection.classList.add('d-none');
      checkoutSection.classList.remove('d-none');
      window.scrollTo({ top: 0, behavior: 'smooth' });
    };

    document.getElementById("checkout-button")?.addEventListener("click", openCheckout);

    // Order type change handler
    const orderTypeSelect = document.getElementById('orderType');
    const addressGroup = document.getElementById('address-group');
    const addressInput = document.getElementById('address');
    const paymentSelect = document.getElementById('payment');
    
    // Store Cash On Delivery option template for later restoration
    let cashOnDeliveryOptionTemplate = null;
    if (paymentSelect) {
      const existingOption = paymentSelect.querySelector('option[value="Cash On Delivery"]');
      if (existingOption) {
        cashOnDeliveryOptionTemplate = existingOption.cloneNode(true);
      }
    }
    
    // Store Pay at the store option template for later restoration
    let payAtStoreOptionTemplate = null;
    if (paymentSelect) {
      const existingPayAtStoreOption = paymentSelect.querySelector('option[value="Pay at the store"]');
      if (existingPayAtStoreOption) {
        payAtStoreOptionTemplate = existingPayAtStoreOption.cloneNode(true);
        // Initially remove it (hidden by default for Delivery)
        existingPayAtStoreOption.remove();
      }
    }

    function togglePaymentMethods(isPickup) {
      if (!paymentSelect) return;
      
      const cashOnDeliveryOption = paymentSelect.querySelector('option[value="Cash On Delivery"]');
      const payAtStoreOption = paymentSelect.querySelector('option[value="Pay at the store"]');
      
      if (isPickup) {
        // For Pickup: Remove Cash On Delivery, Show Pay at the store
        if (cashOnDeliveryOption) {
          // If Cash On Delivery was selected, switch to Pay at the store
          if (paymentSelect.value === 'Cash On Delivery') {
            paymentSelect.value = 'Pay at the store';
          }
          cashOnDeliveryOption.remove();
        }
        
        // Show Pay at the store option if it doesn't exist
        if (!payAtStoreOption && payAtStoreOptionTemplate) {
          const newOption = payAtStoreOptionTemplate.cloneNode(true);
          // Insert after GCash option
          const gcashOption = paymentSelect.querySelector('option[value="GCash"]');
          if (gcashOption && gcashOption.nextSibling) {
            paymentSelect.insertBefore(newOption, gcashOption.nextSibling);
          } else {
            paymentSelect.appendChild(newOption);
          }
        }
      } else {
        // For Delivery: Show Cash On Delivery, Hide Pay at the store
        if (!cashOnDeliveryOption && cashOnDeliveryOptionTemplate) {
          // Restore Cash On Delivery option if it doesn't exist
          const newOption = cashOnDeliveryOptionTemplate.cloneNode(true);
          // Insert after the "Select Payment Method" option
          const selectOption = paymentSelect.querySelector('option[value=""]');
          if (selectOption && selectOption.nextSibling) {
            paymentSelect.insertBefore(newOption, selectOption.nextSibling);
          } else {
            paymentSelect.appendChild(newOption);
          }
        }
        
        // Remove Pay at the store option
        if (payAtStoreOption) {
          // If Pay at the store was selected, switch to Cash On Delivery
          if (paymentSelect.value === 'Pay at the store') {
            paymentSelect.value = 'Cash On Delivery';
          }
          payAtStoreOption.remove();
        }
      }
    }

    if (orderTypeSelect && addressGroup && addressInput) {
      orderTypeSelect.addEventListener('change', () => {
        if (orderTypeSelect.value === 'Pickup') {
          addressGroup.style.display = 'none';
          addressInput.removeAttribute('required');
          addressInput.value = '';
          
          // Update payment methods for Pickup orders
          togglePaymentMethods(true);
        } else {
          addressGroup.style.display = 'block';
          addressInput.setAttribute('required', 'required');
          
          // Update payment methods for Delivery orders
          togglePaymentMethods(false);
        }
      });
      
      // Initialize on page load
      if (orderTypeSelect.value === 'Pickup') {
        togglePaymentMethods(true);
      } else {
        togglePaymentMethods(false);
      }
    }
  </script>
</body>
</html>
